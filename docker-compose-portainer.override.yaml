version: '3.8'
services:
  nagios:
    build:
      context: .
      dockerfile: Dockerfile_TMU
      platforms:
        - linux/amd64
      tags:
        - tmumuellerj/docker-nagios:tmu
    image: tmumuellerj/docker-nagios:tmu
    volumes: !override
      - nagios_etc:/opt/nagios/etc
      - nagios_var:/opt/nagios/var
      - nagios_ssh:/home/nagios/.ssh
      - nagios_confd:/etc/apache2/conf.d
      - nagios_log:/var/log/apache2
      - myCertificates:/etc/apache2/ssl
    dns:
      - ${DNS_SERVER1}
      - ${DNS_SERVER2}
    dns_search:
      - ${DNS_SEARCH_DOMAIN}
    environment:
      - DNS_SERVER1=${DNS_SERVER1}
      - DNS_SERVER2=${DNS_SERVER2}
      - DNS_SEARCH_DOMAIN=${DNS_SEARCH_DOMAIN}
      - NAGIOSADMIN_USER=nagiosadmin

volumes:
  nagios_etc:
  nagios_var:
  nagios_ssh:
  nagios_confd:
  nagios_log:
  myCertificates:
    external: true
